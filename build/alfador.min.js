!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.alfador=t()}}(function(){return function t(a,i,s){function n(r,e){if(!i[r]){if(!a[r]){var o="function"==typeof require&&require;if(!e&&o)return o(r,!0);if(h)return h(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[r]={exports:{}};a[r][0].call(u.exports,function(t){var i=a[r][1][t];return n(i?i:t)},u,u.exports,t,a,i,s)}return i[r].exports}for(var h="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({1:[function(t,a,i){!function(){"use strict";a.exports={Mat33:t("./Mat33"),Mat44:t("./Mat44"),Vec2:t("./Vec2"),Vec3:t("./Vec3"),Vec4:t("./Vec3"),Quaternion:t("./Quaternion"),Transform:t("./Transform"),Triangle:t("./Triangle")}}()},{"./Mat33":2,"./Mat44":3,"./Quaternion":4,"./Transform":5,"./Triangle":6,"./Vec2":7,"./Vec3":8}],2:[function(t,a,i){!function(){"use strict";function i(t){if(!t)return i.identity();if(t instanceof i)this.data=t.data.slice(0);else if(t.data&&16===t.data.length)this.data=[t.data[0],t.data[1],t.data[2],t.data[4],t.data[5],t.data[6],t.data[8],t.data[9],t.data[10]];else{if(9!==t.length)return i.identity();this.data=Array.prototype.slice.call(t)}return this}var s=t("./Vec3"),n=t("./Vec4");i.prototype.row=function(t){return new s(this.data[0+t],this.data[3+t],this.data[6+t])},i.prototype.col=function(t){return new s(this.data[0+3*t],this.data[1+3*t],this.data[2+3*t])},i.identity=function(){return new i([1,0,0,0,1,0,0,0,1])},i.scale=function(t){return new i(t instanceof Array?[t[0],0,0,0,t[1],0,0,0,t[2]]:t instanceof s?[t.x,0,0,0,t.y,0,0,0,t.z]:[t,0,0,0,t,0,0,0,t])},i.rotationDegrees=function(t,a){return this.rotationRadians(t*Math.PI/180,a)},i.rotationRadians=function(t,a){if(a instanceof Array&&(a=new s(a)),0===a.lengthSquared())return this.identity();var n=a.normalize(),h=n.x,r=n.y,e=n.z,o=t>0?t%(2*Math.PI):t%(-2*Math.PI),d=Math.sin(o),u=Math.cos(o),c=h*h,f=r*r,y=e*e,l=h*r,p=r*e,w=e*h,x=h*d,m=r*d,z=e*d,g=1-u;return new i([g*c+u,g*l+z,g*w-m,g*l-z,g*f+u,g*p+x,g*w+m,g*p-x,g*y+u])},i.rotationFromTo=function(t,a){var n,h,r,e,o,d,u,c,f,y,l,p=1e-6,w=new s(t).normalize(),x=new s(a).normalize(),m=w.dot(x),z=Math.abs(m),g=new i;return z>1-p?(e=Math.abs(w.x),o=Math.abs(w.y),d=Math.abs(w.z),n=o>e?d>e?new s(1,0,0):new s(0,0,1):d>o?new s(0,1,0):new s(0,0,1),h=n.sub(w),r=n.sub(x),f=2/h.dot(h),y=2/r.dot(r),l=f*y*h.dot(r),g.data[0]=-f*h.x*h.x-y*r.x*r.x+l*r.x*h.x,g.data[3]=-f*h.x*h.y-y*r.x*r.y+l*r.x*h.y,g.data[6]=-f*h.x*h.z-y*r.x*r.z+l*r.x*h.z,g.data[1]=-f*h.y*h.x-y*r.y*r.x+l*r.y*h.x,g.data[4]=-f*h.y*h.y-y*r.y*r.y+l*r.y*h.y,g.data[7]=-f*h.y*h.z-y*r.y*r.z+l*r.y*h.z,g.data[2]=-f*h.z*h.x-y*r.z*r.x+l*r.z*h.x,g.data[5]=-f*h.z*h.y-y*r.z*r.y+l*r.z*h.y,g.data[8]=-f*h.z*h.z-y*r.z*r.z+l*r.z*h.z,g.data[0]+=1,g.data[4]+=1,g.data[8]+=1):(r=w.cross(x),h=1/(1+m),u=h*r.x,c=h*r.z,f=u*r.y,y=u*r.z,l=c*r.y,g.data[0]=m+u*r.x,g.data[3]=f-r.z,g.data[6]=y+r.y,g.data[1]=f+r.z,g.data[4]=m+h*r.y*r.y,g.data[7]=l-r.x,g.data[2]=y-r.y,g.data[5]=l+r.x,g.data[8]=m+c*r.z),g},i.prototype.add=function(t){var a,s=new i(t);for(a=0;9>a;a++)s.data[a]+=this.data[a];return s},i.prototype.sub=function(t){var a,s=new i(t);for(a=0;9>a;a++)s.data[a]=this.data[a]-s.data[a];return s},i.prototype.multVector=function(t){return new s({x:this.data[0]*t.x+this.data[3]*t.y+this.data[6]*t.z,y:this.data[1]*t.x+this.data[4]*t.y+this.data[7]*t.z,z:this.data[2]*t.x+this.data[5]*t.y+this.data[8]*t.z})},i.prototype.multScalar=function(t){var a,s=new i;for(a=0;9>a;a++)s.data[a]=this.data[a]*t;return s},i.prototype.multMatrix=function(t){var a,s=new i;for(t=t instanceof i?t:new i(t),a=0;3>a;a++)s.data[a]=this.data[a]*t.data[0]+this.data[a+3]*t.data[1]+this.data[a+6]*t.data[2],s.data[a+3]=this.data[a]*t.data[3]+this.data[a+3]*t.data[4]+this.data[a+6]*t.data[5],s.data[a+6]=this.data[a]*t.data[6]+this.data[a+3]*t.data[7]+this.data[a+6]*t.data[8];return s},i.prototype.mult=function(t){return"number"==typeof t?this.multScalar(t):t instanceof Array?this.multVector(new s(t)):t instanceof s||t instanceof n?this.multVector(t):this.multMatrix(t)},i.prototype.div=function(t){var a,s=new i;for(a=0;9>a;a++)s.data[a]=this.data[a]/t;return s},i.prototype.equals=function(t,a){var i;for(a=void 0===a?0:a,i=0;9>i;i++)if(!(this.data[i]===t.data[i]||Math.abs(this.data[i]-t.data[i])<=a))return!1;return!0},i.prototype.transpose=function(){var t,a=new i;for(t=0;3>t;t++)a.data[3*t]=this.data[t],a.data[3*t+1]=this.data[t+3],a.data[3*t+2]=this.data[t+6];return a},i.prototype.inverse=function(){var t,a=new i;return a.data[0]=this.data[4]*this.data[8]-this.data[7]*this.data[5],a.data[3]=-this.data[3]*this.data[8]+this.data[6]*this.data[5],a.data[6]=this.data[3]*this.data[7]-this.data[6]*this.data[4],a.data[1]=-this.data[1]*this.data[8]+this.data[7]*this.data[2],a.data[4]=this.data[0]*this.data[8]-this.data[6]*this.data[2],a.data[7]=-this.data[0]*this.data[7]+this.data[6]*this.data[1],a.data[2]=this.data[1]*this.data[5]-this.data[4]*this.data[2],a.data[5]=-this.data[0]*this.data[5]+this.data[3]*this.data[2],a.data[8]=this.data[0]*this.data[4]-this.data[3]*this.data[1],t=this.data[0]*a.data[0]+this.data[1]*a.data[3]+this.data[2]*a.data[6],a.mult(1/t)},i.prototype.decompose=function(){var t=this.col(0),a=this.col(1),i=this.col(2);return{left:t.normalize(),up:a.normalize(),forward:i.normalize(),scale:new s(t.length(),a.length(),i.length())}},i.random=function(){var t=i.rotationRadians(360*Math.random(),s.random()),a=i.scale(10*Math.random());return t.mult(a)},i.prototype.toString=function(){return this.data[0]+", "+this.data[3]+", "+this.data[6]+",\n"+this.data[1]+", "+this.data[4]+", "+this.data[7]+",\n"+this.data[2]+", "+this.data[5]+", "+this.data[8]},i.prototype.toArray=function(){return this.data.slice(0)},a.exports=i}()},{"./Vec3":8,"./Vec4":9}],3:[function(t,a,i){!function(){"use strict";function i(t){if(!t)return i.identity();if(t instanceof h)this.data=[t.data[0],t.data[1],t.data[2],0,t.data[3],t.data[4],t.data[5],0,t.data[6],t.data[7],t.data[8],0,0,0,0,1];else if(t instanceof i)this.data=t.data.slice(0);else{if(16!==t.length)return i.identity();this.data=Array.prototype.slice.call(t)}return this}var s=t("./Vec3"),n=t("./Vec4"),h=t("./Mat33");i.prototype.row=function(t){return new n(this.data[0+t],this.data[4+t],this.data[8+t],this.data[12+t])},i.prototype.col=function(t){return new n(this.data[0+4*t],this.data[1+4*t],this.data[2+4*t],this.data[3+4*t])},i.identity=function(){return new i([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},i.scale=function(t){return new i(t instanceof Array?[t[0],0,0,0,0,t[1],0,0,0,0,t[2],0,0,0,0,1]:t instanceof s?[t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1]:[t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1])},i.translation=function(t){return new i(t instanceof Array?[1,0,0,0,0,1,0,0,0,0,1,0,t[0],t[1],t[2],1]:[1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1])},i.rotationDegrees=function(t,a){return new i(h.rotationDegrees(t,a))},i.rotationRadians=function(t,a){return new i(h.rotationRadians(t,a))},i.rotationFromTo=function(t,a){return new i(h.rotationFromTo(t,a))},i.prototype.add=function(t){var a,s=new i(t);for(a=0;16>a;a++)s.data[a]+=this.data[a];return s},i.prototype.sub=function(t){var a,s=new i(t);for(a=0;16>a;a++)s.data[a]=this.data[a]-s.data[a];return s},i.prototype.multVector3=function(t){return new s({x:this.data[0]*t.x+this.data[4]*t.y+this.data[8]*t.z+this.data[12],y:this.data[1]*t.x+this.data[5]*t.y+this.data[9]*t.z+this.data[13],z:this.data[2]*t.x+this.data[6]*t.y+this.data[10]*t.z+this.data[14]})},i.prototype.multVector4=function(t){return new n({x:this.data[0]*t.x+this.data[4]*t.y+this.data[8]*t.z+this.data[12]*t.w,y:this.data[1]*t.x+this.data[5]*t.y+this.data[9]*t.z+this.data[13]*t.w,z:this.data[2]*t.x+this.data[6]*t.y+this.data[10]*t.z+this.data[14]*t.w,w:this.data[3]*t.x+this.data[7]*t.y+this.data[11]*t.z+this.data[15]*t.w})},i.prototype.multScalar=function(t){var a,s=new i;for(a=0;16>a;a++)s.data[a]=this.data[a]*t;return s},i.prototype.multMatrix=function(t){var a,s=new i;for(t=t instanceof i?t:new i(t),a=0;4>a;a++)s.data[a]=this.data[a]*t.data[0]+this.data[a+4]*t.data[1]+this.data[a+8]*t.data[2]+this.data[a+12]*t.data[3],s.data[a+4]=this.data[a]*t.data[4]+this.data[a+4]*t.data[5]+this.data[a+8]*t.data[6]+this.data[a+12]*t.data[7],s.data[a+8]=this.data[a]*t.data[8]+this.data[a+4]*t.data[9]+this.data[a+8]*t.data[10]+this.data[a+12]*t.data[11],s.data[a+12]=this.data[a]*t.data[12]+this.data[a+4]*t.data[13]+this.data[a+8]*t.data[14]+this.data[a+12]*t.data[15];return s},i.prototype.mult=function(t){return"number"==typeof t?this.multScalar(t):t instanceof Array?3===t.length?this.multVector3(new s(t)):this.multVector4(new n(t)):t instanceof s?this.multVector3(t):t instanceof n?this.multVector4(new i(t)):this.multMatrix(t)},i.prototype.div=function(t){var a,s=new i;for(a=0;16>a;a++)s.data[a]=this.data[a]/t;return s},i.prototype.equals=function(t,a){var i;for(a=void 0===a?0:a,i=0;16>i;i++)if(!(this.data[i]===t.data[i]||Math.abs(this.data[i]-t.data[i])<=a))return!1;return!0},i.ortho=function(t,a,s,n,h,r){var e=i.identity();return e.data[0]=2/(a-t),e.data[5]=2/(n-s),e.data[10]=-2/(r-h),e.data[12]=-((a+t)/(a-t)),e.data[13]=-((n+s)/(n-s)),e.data[14]=-((r+h)/(r-h)),e},i.perspective=function(t,a,s,n){var h=s*Math.tan(t*(Math.PI/360)),r=-h,e=r*a,o=-e,d=i.identity();return d.data[0]=2*s/(o-e),d.data[5]=2*s/(h-r),d.data[8]=(o+e)/(o-e),d.data[9]=(h+r)/(h-r),d.data[10]=-((n+s)/(n-s)),d.data[11]=-1,d.data[14]=-(2*n*s/(n-s)),d.data[15]=0,d},i.prototype.transpose=function(){var t,a=new i;for(t=0;4>t;t++)a.data[4*t]=this.data[t],a.data[4*t+1]=this.data[t+4],a.data[4*t+2]=this.data[t+8],a.data[4*t+3]=this.data[t+12];return a},i.prototype.inverse=function(){var t,a=new i;return a.data[0]=this.data[5]*this.data[10]*this.data[15]-this.data[5]*this.data[11]*this.data[14]-this.data[9]*this.data[6]*this.data[15]+this.data[9]*this.data[7]*this.data[14]+this.data[13]*this.data[6]*this.data[11]-this.data[13]*this.data[7]*this.data[10],a.data[4]=-this.data[4]*this.data[10]*this.data[15]+this.data[4]*this.data[11]*this.data[14]+this.data[8]*this.data[6]*this.data[15]-this.data[8]*this.data[7]*this.data[14]-this.data[12]*this.data[6]*this.data[11]+this.data[12]*this.data[7]*this.data[10],a.data[8]=this.data[4]*this.data[9]*this.data[15]-this.data[4]*this.data[11]*this.data[13]-this.data[8]*this.data[5]*this.data[15]+this.data[8]*this.data[7]*this.data[13]+this.data[12]*this.data[5]*this.data[11]-this.data[12]*this.data[7]*this.data[9],a.data[12]=-this.data[4]*this.data[9]*this.data[14]+this.data[4]*this.data[10]*this.data[13]+this.data[8]*this.data[5]*this.data[14]-this.data[8]*this.data[6]*this.data[13]-this.data[12]*this.data[5]*this.data[10]+this.data[12]*this.data[6]*this.data[9],a.data[1]=-this.data[1]*this.data[10]*this.data[15]+this.data[1]*this.data[11]*this.data[14]+this.data[9]*this.data[2]*this.data[15]-this.data[9]*this.data[3]*this.data[14]-this.data[13]*this.data[2]*this.data[11]+this.data[13]*this.data[3]*this.data[10],a.data[5]=this.data[0]*this.data[10]*this.data[15]-this.data[0]*this.data[11]*this.data[14]-this.data[8]*this.data[2]*this.data[15]+this.data[8]*this.data[3]*this.data[14]+this.data[12]*this.data[2]*this.data[11]-this.data[12]*this.data[3]*this.data[10],a.data[9]=-this.data[0]*this.data[9]*this.data[15]+this.data[0]*this.data[11]*this.data[13]+this.data[8]*this.data[1]*this.data[15]-this.data[8]*this.data[3]*this.data[13]-this.data[12]*this.data[1]*this.data[11]+this.data[12]*this.data[3]*this.data[9],a.data[13]=this.data[0]*this.data[9]*this.data[14]-this.data[0]*this.data[10]*this.data[13]-this.data[8]*this.data[1]*this.data[14]+this.data[8]*this.data[2]*this.data[13]+this.data[12]*this.data[1]*this.data[10]-this.data[12]*this.data[2]*this.data[9],a.data[2]=this.data[1]*this.data[6]*this.data[15]-this.data[1]*this.data[7]*this.data[14]-this.data[5]*this.data[2]*this.data[15]+this.data[5]*this.data[3]*this.data[14]+this.data[13]*this.data[2]*this.data[7]-this.data[13]*this.data[3]*this.data[6],a.data[6]=-this.data[0]*this.data[6]*this.data[15]+this.data[0]*this.data[7]*this.data[14]+this.data[4]*this.data[2]*this.data[15]-this.data[4]*this.data[3]*this.data[14]-this.data[12]*this.data[2]*this.data[7]+this.data[12]*this.data[3]*this.data[6],a.data[10]=this.data[0]*this.data[5]*this.data[15]-this.data[0]*this.data[7]*this.data[13]-this.data[4]*this.data[1]*this.data[15]+this.data[4]*this.data[3]*this.data[13]+this.data[12]*this.data[1]*this.data[7]-this.data[12]*this.data[3]*this.data[5],a.data[14]=-this.data[0]*this.data[5]*this.data[14]+this.data[0]*this.data[6]*this.data[13]+this.data[4]*this.data[1]*this.data[14]-this.data[4]*this.data[2]*this.data[13]-this.data[12]*this.data[1]*this.data[6]+this.data[12]*this.data[2]*this.data[5],a.data[3]=-this.data[1]*this.data[6]*this.data[11]+this.data[1]*this.data[7]*this.data[10]+this.data[5]*this.data[2]*this.data[11]-this.data[5]*this.data[3]*this.data[10]-this.data[9]*this.data[2]*this.data[7]+this.data[9]*this.data[3]*this.data[6],a.data[7]=this.data[0]*this.data[6]*this.data[11]-this.data[0]*this.data[7]*this.data[10]-this.data[4]*this.data[2]*this.data[11]+this.data[4]*this.data[3]*this.data[10]+this.data[8]*this.data[2]*this.data[7]-this.data[8]*this.data[3]*this.data[6],a.data[11]=-this.data[0]*this.data[5]*this.data[11]+this.data[0]*this.data[7]*this.data[9]+this.data[4]*this.data[1]*this.data[11]-this.data[4]*this.data[3]*this.data[9]-this.data[8]*this.data[1]*this.data[7]+this.data[8]*this.data[3]*this.data[5],a.data[15]=this.data[0]*this.data[5]*this.data[10]-this.data[0]*this.data[6]*this.data[9]-this.data[4]*this.data[1]*this.data[10]+this.data[4]*this.data[2]*this.data[9]+this.data[8]*this.data[1]*this.data[6]-this.data[8]*this.data[2]*this.data[5],t=this.data[0]*a.data[0]+this.data[1]*a.data[4]+this.data[2]*a.data[8]+this.data[3]*a.data[12],a.mult(1/t)},i.prototype.decompose=function(){var t=new s(this.col(0)),a=new s(this.col(1)),i=new s(this.col(2)),n=new s(this.col(3));return{left:t.normalize(),up:a.normalize(),forward:i.normalize(),origin:n,scale:new s(t.length(),a.length(),i.length())}},i.random=function(){var t=i.rotationRadians(360*Math.random(),s.random()),a=i.scale(10*Math.random()),n=i.translation(s.random());return n.mult(t.mult(a))},i.prototype.toString=function(){return this.data[0]+", "+this.data[4]+", "+this.data[8]+", "+this.data[12]+",\n"+this.data[1]+", "+this.data[5]+", "+this.data[9]+", "+this.data[13]+",\n"+this.data[2]+", "+this.data[6]+", "+this.data[10]+", "+this.data[14]+",\n"+this.data[3]+", "+this.data[7]+", "+this.data[11]+", "+this.data[15]},i.prototype.toArray=function(){return this.data.slice(0)},a.exports=i}()},{"./Mat33":2,"./Vec3":8,"./Vec4":9}],4:[function(t,a,i){!function(){"use strict";function i(){switch(arguments.length){case 1:var t=arguments[0];this.w=void 0!==t.w?t.w:void 0!==t[0]?t[0]:1,this.x=t.x||t[1]||0,this.y=t.y||t[2]||0,this.z=t.z||t[3]||0;break;case 4:this.w=arguments[0],this.x=arguments[1],this.y=arguments[2],this.z=arguments[3];break;default:this.w=1,this.x=0,this.y=0,this.z=0}return this}var s=t("./Vec3"),n=t("./Mat33");i.identity=function(){return new i(1,0,0,0)},i.prototype.multQuaternion=function(t){var a=t.w*this.w-t.x*this.x-t.y*this.y-t.z*this.z,s=this.y*t.z-this.z*t.y+this.w*t.x+this.x*t.w,n=this.z*t.x-this.x*t.z+this.w*t.y+this.y*t.w,h=this.x*t.y-this.y*t.x+this.w*t.z+this.z*t.w;return new i(a,s,n,h)},i.prototype.multVector=function(t){var a=new i(0,t.x,t.y,t.z),n=this.multQuaternion(a).multQuaternion(this.inverse());return new s(n.x,n.y,n.z)},i.prototype.mult=function(t){return t instanceof i?this.multQuaternion(t):this.multVector(t)},i.prototype.matrix=function(){var t=this.x*this.x,a=this.y*this.y,i=this.z*this.z,s=this.x*this.y,h=this.x*this.z,r=this.x*this.w,e=this.y*this.z,o=this.y*this.w,d=this.z*this.w;return new n([1-2*a-2*i,2*s+2*d,2*h-2*o,2*s-2*d,1-2*t-2*i,2*e+2*r,2*h+2*o,2*e-2*r,1-2*t-2*a])},i.rotationDegrees=function(t,a){return i.rotationRadians(t*(Math.PI/180),a)},i.rotationRadians=function(t,a){t=t>0?t%(2*Math.PI):t%(-2*Math.PI),a=a.normalize();var s=Math.sin(t/2),n=Math.cos(t/2);return new i(n,a.x*s,a.y*s,a.z*s).normalize()},i.prototype.equals=function(t,a){return a=void 0===a?0:a,(this.x===t.x||Math.abs(this.x-t.x)<=a)&&(this.y===t.y||Math.abs(this.y-t.y)<=a)&&(this.z===t.z||Math.abs(this.z-t.z)<=a)&&(this.w===t.w||Math.abs(this.w-t.w)<=a)},i.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0!==t?new i(this.w/t,this.x/t,this.y/t,this.z/t):new i},i.prototype.conjugate=function(){return new i(this.w,-this.x,-this.y,-this.z)},i.prototype.inverse=function(){return this.conjugate()},i.random=function(){var t=s.random().normalize(),a=Math.random();return i.rotationRadians(a,t)},i.prototype.toString=function(){return this.x+", "+this.y+", "+this.z+", "+this.w},i.prototype.toArray=function(){return[this.w,this.x,this.y,this.z]},a.exports=i}()},{"./Mat33":2,"./Vec3":8}],5:[function(t,a,i){!function(){"use strict";function i(t){return t=t||{},t instanceof i?(this._up=t.up(),this._forward=t.forward(),this._left=t.left(),this._origin=t.origin(),this._scale=t.scale()):t instanceof h||t instanceof n?(t=t.decompose(),this._up=t.up,this._forward=t.forward,this._left=t.left,this._scale=t.scale,this._origin=t.origin||new s(0,0,0)):(this._up=t.up?new s(t.up).normalize():new s(0,1,0),this._forward=t.forward?new s(t.forward).normalize():new s(0,0,1),this._left=t.left?new s(t.left).normalize():this._up.cross(this._forward).normalize(),this.origin(t.origin||new s(0,0,0)),this.scale(t.scale||new s(1,1,1))),this}var s=t("./Vec3"),n=t("./Mat33"),h=t("./Mat44");i.identity=function(){return new i({up:new s(0,1,0),forward:new s(0,0,1),left:new s(1,0,0),origin:new s(0,0,0),scale:new s(1,1,1)})},i.prototype.origin=function(t){return t?(this._origin=new s(t),this):new s(this._origin)},i.prototype.forward=function(t){if(t){t=t instanceof Array?new s(t).normalize():t.normalize();var a=n.rotationFromTo(this._forward,t);return this._forward=t,this._up=a.mult(this._up).normalize(),this._left=a.mult(this._left).normalize(),this}return new s(this._forward)},i.prototype.up=function(t){if(t){t=t instanceof Array?new s(t).normalize():t.normalize();var a=n.rotationFromTo(this._up,t);return this._forward=a.mult(this._forward).normalize(),this._up=t,this._left=a.mult(this._left).normalize(),this}return new s(this._up)},i.prototype.left=function(t){if(t){t=t instanceof Array?new s(t).normalize():t.normalize();var a=n.rotationFromTo(this._left,t);return this._forward=a.mult(this._forward).normalize(),this._up=a.mult(this._up).normalize(),this._left=t,this}return new s(this._left)},i.prototype.scale=function(t){return t?(this._scale="number"==typeof t?new s(t,t,t):new s(t),this):this._scale},i.prototype.mult=function(t){return t instanceof i?new i(this.matrix().mult(t.matrix())):t instanceof n||t instanceof h||t instanceof Array?new i(this.matrix().mult(t)):i.identity()},i.prototype.scaleMatrix=function(){return h.scale(this._scale)},i.prototype.rotationMatrix=function(){return new h([this._left.x,this._left.y,this._left.z,0,this._up.x,this._up.y,this._up.z,0,this._forward.x,this._forward.y,this._forward.z,0,0,0,0,1])},i.prototype.translationMatrix=function(){return h.translation(this._origin)},i.prototype.matrix=function(){return this.translationMatrix().mult(this.rotationMatrix()).mult(this.scaleMatrix())},i.prototype.inverseScaleMatrix=function(){return h.scale(new s(1/this._scale.x,1/this._scale.y,1/this._scale.z))},i.prototype.inverseRotationMatrix=function(){return new h([this._left.x,this._up.x,this._forward.x,0,this._left.y,this._up.y,this._forward.y,0,this._left.z,this._up.z,this._forward.z,0,0,0,0,1])},i.prototype.inverseTranslationMatrix=function(){return h.translation(this._origin.negate())},i.prototype.inverseMatrix=function(){return this.inverseScaleMatrix().mult(this.inverseRotationMatrix()).mult(this.inverseTranslationMatrix())},i.prototype.viewMatrix=function(){var t=this._origin.negate(),a=this._left.negate(),i=this._forward.negate();return new h([a.x,this._up.x,i.x,0,a.y,this._up.y,i.y,0,a.z,this._up.z,i.z,0,t.dot(a),t.dot(this._up),t.dot(i),1])},i.prototype.translateWorld=function(t){return this._origin=this._origin.add(t),this},i.prototype.translateLocal=function(t){return t instanceof Array&&(t=new s(t)),this._origin=this._origin.add(this._left.mult(t.x)).add(this._up.mult(t.y)).add(this._forward.mult(t.z)),this},i.prototype.rotateWorldDegrees=function(t,a){return this.rotateWorldRadians(t*Math.PI/180,a)},i.prototype.rotateWorldRadians=function(t,a){var i=n.rotationRadians(t,a);return this._up=i.mult(this._up),this._forward=i.mult(this._forward),this._left=i.mult(this._left),this},i.prototype.rotateLocalDegrees=function(t,a){return this.rotateWorldDegrees(t,this.rotationMatrix().mult(a))},i.prototype.rotateLocalRadians=function(t,a){return this.rotateWorldRadians(t,this.rotationMatrix().mult(a))},i.prototype.localToWorld=function(t,a,i,s){var n=new h;return a||(n=this.scaleMatrix().mult(n)),i||(n=this.rotationMatrix().mult(n)),s||(n=this.translationMatrix().mult(n)),n.mult(t)},i.prototype.worldToLocal=function(t,a,i,s){var n=new h;return s||(n=this.inverseTranslationMatrix().mult(n)),i||(n=this.inverseRotationMatrix().mult(n)),a||(n=this.inverseScaleMatrix().mult(n)),n.mult(t)},i.prototype.equals=function(t,a){return this._origin.equals(t.origin(),a)&&this._forward.equals(t.forward(),a)&&this._up.equals(t.up(),a)&&this._left.equals(t.left(),a)&&this._scale.equals(t.scale(),a)},i.random=function(){return(new i).origin(s.random()).forward(s.random()).scale(s.random())},i.prototype.toString=function(){return this.matrix().toString()},a.exports=i}()},{"./Mat33":2,"./Mat44":3,"./Vec3":8}],6:[function(t,a,i){!function(){"use strict";function i(){switch(arguments.length){case 1:var t=arguments[0];this.a=t[0]||t.a,this.b=t[1]||t.b,this.c=t[2]||t.c;break;case 3:this.a=arguments[0],this.b=arguments[1],this.c=arguments[2];break;default:this.a=new s(0,0,0),this.b=new s(1,0,0),this.c=new s(1,1,0)}}var s=t("./Vec3");i.prototype.radius=function(){var t=this.centroid(),a=this.a.sub(t).length(),i=this.b.sub(t).length(),s=this.c.sub(t).length();return Math.max(a,Math.max(i,s))},i.prototype.centroid=function(){return this.a.add(this.b).add(this.c).div(3)},i.prototype.normal=function(){var t=this.b.sub(this.a),a=this.c.sub(this.a);return t.cross(a).normalize()},i.random=function(){var t=s.random(),a=s.random(),n=s.random(),h=t.add(a).add(n).div(3),r=t.sub(h),e=a.sub(h),o=n.sub(h),d=r.length(),u=e.length(),c=o.length(),f=Math.max(Math.max(d,u),c),y=1/f;return new i(r.mult(y),e.mult(y),o.mult(y))},i.prototype.equals=function(t,a){return a=void 0===a?0:a,(this.a===t.a||Math.abs(this.a-t.a)<=a)&&(this.b===t.b||Math.abs(this.b-t.b)<=a)&&(this.c===t.c||Math.abs(this.c-t.c)<=a)},i.prototype.toString=function(){return this.a.toString()+", "+this.b.toString()+", "+this.c.toString()},a.exports=i}()},{"./Vec3":8}],7:[function(t,a,i){!function(){"use strict";function t(){switch(arguments.length){case 1:var t=arguments[0];this.x=t.x||t[0]||0,this.y=t.y||t[1]||0;break;case 2:this.x=arguments[0],this.y=arguments[1];break;default:this.x=0,this.y=0}return this}t.prototype.negate=function(){return new t(-this.x,-this.y)},t.prototype.add=function(a){return a instanceof Array?new t(this.x+a[0],this.y+a[1]):new t(this.x+a.x,this.y+a.y)},t.prototype.sub=function(a){return a instanceof Array?new t(this.x-a[0],this.y-a[1]):new t(this.x-a.x,this.y-a.y)},t.prototype.mult=function(a){return new t(this.x*a,this.y*a)},t.prototype.div=function(a){return new t(this.x/a,this.y/a)},t.prototype.dot=function(t){return t instanceof Array?this.x*t[0]+this.y*t[1]:this.x*t.x+this.y*t.y},t.prototype.cross=function(t){return t instanceof Array?this.x*t[1]-this.y*t[0]:this.x*t.y-this.y*t.x},t.prototype.length=function(t){return void 0===t?Math.sqrt(this.dot(this)):this.normalize().mult(t)},t.prototype.lengthSquared=function(){return this.dot(this)},t.prototype.equals=function(t,a){var i=void 0!==t.x?t.x:t[0],s=void 0!==t.y?t.y:t[1];return a=void 0===a?0:a,(this.x===i||Math.abs(this.x-i)<=a)&&(this.y===s||Math.abs(this.y-s)<=a)},t.prototype.normalize=function(){var a=this.length();return 0!==a?new t(this.x/a,this.y/a):new t},t.random=function(){return new t(Math.random(),Math.random()).normalize()},t.prototype.toString=function(){return this.x+", "+this.y},t.prototype.toArray=function(){return[this.x,this.y]},a.exports=t}()},{}],8:[function(t,a,i){!function(){"use strict";function t(){switch(arguments.length){case 1:var t=arguments[0];this.x=t.x||t[0]||0,this.y=t.y||t[1]||0,this.z=t.z||t[2]||0;break;case 3:this.x=arguments[0],this.y=arguments[1],this.z=arguments[2];break;default:this.x=0,this.y=0,this.z=0}return this}t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.add=function(a){return a instanceof Array?new t(this.x+a[0],this.y+a[1],this.z+a[2]):new t(this.x+a.x,this.y+a.y,this.z+a.z)},t.prototype.sub=function(a){return a instanceof Array?new t(this.x-a[0],this.y-a[1],this.z-a[2]):new t(this.x-a.x,this.y-a.y,this.z-a.z)},t.prototype.mult=function(a){return new t(this.x*a,this.y*a,this.z*a)},t.prototype.div=function(a){return new t(this.x/a,this.y/a,this.z/a)},t.prototype.dot=function(t){return t instanceof Array?this.x*t[0]+this.y*t[1]+this.z*t[2]:this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.cross=function(a){return a instanceof Array?new t(this.y*a[2]-a[1]*this.z,-this.x*a[2]+a[0]*this.z,this.x*a[1]-a[0]*this.y):new t(this.y*a.z-a.y*this.z,-this.x*a.z+a.x*this.z,this.x*a.y-a.x*this.y)},t.prototype.length=function(t){return void 0===t?Math.sqrt(this.dot(this)):this.normalize().mult(t)},t.prototype.lengthSquared=function(){return this.dot(this)},t.prototype.equals=function(t,a){var i=void 0!==t.x?t.x:t[0],s=void 0!==t.y?t.y:t[1],n=void 0!==t.z?t.z:t[2];return a=void 0===a?0:a,(this.x===i||Math.abs(this.x-i)<=a)&&(this.y===s||Math.abs(this.y-s)<=a)&&(this.z===n||Math.abs(this.z-n)<=a)},t.prototype.normalize=function(){var a=this.length();return 0!==a?new t(this.x/a,this.y/a,this.z/a):new t},t.random=function(){return new t(Math.random(),Math.random(),Math.random()).normalize()},t.prototype.toString=function(){return this.x+", "+this.y+", "+this.z},t.prototype.toArray=function(){return[this.x,this.y,this.z]},a.exports=t}()},{}],9:[function(t,a,i){!function(){"use strict";function t(){switch(arguments.length){case 1:var t=arguments[0];this.x=t.x||t[0]||0,this.y=t.y||t[1]||0,this.z=t.z||t[2]||0,this.w=t.w||t[3]||0;break;case 4:this.x=arguments[0],this.y=arguments[1],this.z=arguments[2],this.w=arguments[3];break;default:this.x=0,this.y=0,this.z=0,this.w=0}return this}t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z,-this.w)},t.prototype.add=function(a){return a instanceof Array?new t(this.x+a[0],this.y+a[1],this.z+a[2],this.w+a[3]):new t(this.x+a.x,this.y+a.y,this.z+a.z,this.w+a.w)},t.prototype.sub=function(a){return a instanceof Array?new t(this.x-a[0],this.y-a[1],this.z-a[2],this.w-a[3]):new t(this.x-a.x,this.y-a.y,this.z-a.z,this.w-a.w)},t.prototype.mult=function(a){return new t(this.x*a,this.y*a,this.z*a,this.w*a)},t.prototype.div=function(a){return new t(this.x/a,this.y/a,this.z/a,this.w/a)},t.prototype.dot=function(t){return t instanceof Array?this.x*t[0]+this.y*t[1]+this.z*t[2]+this.w*t[3]:this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},t.prototype.length=function(t){return void 0===t?Math.sqrt(this.dot(this)):this.normalize().mult(t)},t.prototype.lengthSquared=function(){return this.dot(this)},t.prototype.equals=function(t,a){var i=void 0!==t.x?t.x:t[0],s=void 0!==t.y?t.y:t[1],n=void 0!==t.z?t.z:t[2],h=void 0!==t.w?t.w:t[3];return a=void 0===a?0:a,(this.x===i||Math.abs(this.x-i)<=a)&&(this.y===s||Math.abs(this.y-s)<=a)&&(this.z===n||Math.abs(this.z-n)<=a)&&(this.w===h||Math.abs(this.w-h)<=a)},t.prototype.normalize=function(){var a=this.length();return 0!==a?new t(this.x/a,this.y/a,this.z/a,this.w/a):new t},t.random=function(){return new t(Math.random(),Math.random(),Math.random(),Math.random()).normalize()},t.prototype.toString=function(){return this.x+", "+this.y+", "+this.z+", "+this.w},t.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},a.exports=t}()},{}]},{},[1])(1)});